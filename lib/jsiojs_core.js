"use strict";

var fs = require("fs")
var colors = require('colors')
var FS = require("q-io/fs")

var exports = module.exports = {};
  
exports.createFile =  function(fileName){
    checkJsFile(fileName)
    checkFileNotExist(fileName)
    return FS.write(fileName, '// Generated by JsIo.js\n');
  }
  
exports.deleteFile =  function(fileName){
    checkJsFile(fileName)
    checkFileExist(fileName)
    return FS.remove(fileName)
  }
  
exports.renameFile =  function(oldName, newName){
    checkJsFile(oldName)
    checkJsFile(newName)
    checkFileExist(oldName)
    checkFileNotExist(newName)
    return FS.rename(oldName, newName)
  }    

exports.copyFile =  function(source, destination){
    checkJsFile(source)
    checkJsFile(destination)
    checkFileExist(source)
    checkFileNotExist(destination)
    return FS.copy(source, destination);
  }
  
exports.showFile =  function(fileName){
    checkJsFile(fileName)
    checkFileExist(fileName)
    return FS.read(fileName, "r")
  }
  
function checkJsFile(fileName){
  if(fileName === undefined)
    throw "file name is missing";
  if(fileName.length < 4 || fileName.substring(fileName.length-3) !== ".js")
    throw fileName+" is not a valid javascript file name";
}  

function checkFileNotExist(fileName){
  if(fs.existsSync(fileName))
    throw fileName+" already exists"
}

function checkFileExist(fileName){
  if(!fs.existsSync(fileName))
    throw fileName+" does not exist"
}
/* Coming soon
function checkFileNotExist(fileName){
  return FS.exists(fileName).then(function(result){
    if(result)
      throw fileName+" already exists"
    else
      return true
  })
}

function checkFileExist(fileName){
  return FS.exists(fileName).then(function(result){
    if(!result)
      throw fileName+" already exists"
    else
      return true
  })    
    throw fileName+" does not exist"
}

*/

function success(message){
  console.info(message .green)
}
